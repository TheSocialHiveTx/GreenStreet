<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Green street Builders</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              serif: ['Playfair Display', 'serif'],
            },
            colors: {
              greenstreet: {
                50: '#f2f7f4',
                100: '#e1efe6',
                200: '#c5dfcd',
                300: '#9cc5aa',
                400: '#70a483',
                500: '#4d8763',
                600: '#3a6b4d',
                700: '#2f553e',
                800: '#284433',
                900: '#21382b',
              }
            }
          }
        }
      }
    </script>
    <style>
      html { scroll-behavior: smooth; }
      body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
      .loading-spin { animation: spin 1s linear infinite; }
      @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
      .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
    </style>
    <script type="importmap">
    {
      "imports": {
        "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0"
      }
    }
    </script>
  </head>
  <body class="bg-white text-gray-900 font-sans selection:bg-greenstreet-200 selection:text-greenstreet-900">
    
    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-white/95 backdrop-blur-sm border-b border-gray-100 transition-all duration-300">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-20">
          <div class="flex-shrink-0 flex items-center cursor-pointer" onclick="window.switchView('landing'); window.scrollTo(0,0)">
            <div class="h-8 w-8 bg-greenstreet-600 rounded-sm mr-2 flex items-center justify-center">
              <span class="text-white font-serif font-bold text-xl">G</span>
            </div>
            <span class="font-serif font-bold text-xl text-greenstreet-900 tracking-tight">GREEN STREET BUILDERS</span>
          </div>
          
          <div class="hidden md:flex space-x-8 items-center">
            <button onclick="scrollToSection('buyers')" class="text-gray-600 hover:text-greenstreet-600 font-medium transition-colors">Home Buyers</button>
            <button onclick="scrollToSection('sellers')" class="text-gray-600 hover:text-greenstreet-600 font-medium transition-colors">Lot Sellers</button>
            <button onclick="scrollToSection('contact')" class="text-gray-600 hover:text-greenstreet-600 font-medium transition-colors">Contact</button>
            <button onclick="window.switchView('listings')" class="bg-greenstreet-600 text-white px-5 py-2.5 rounded-full font-medium hover:bg-greenstreet-700 transition-all hover:shadow-lg transform hover:-translate-y-0.5">
              Find a Home
            </button>
          </div>

          <div class="md:hidden flex items-center">
            <button id="mobile-menu-btn" class="text-gray-600 p-2">
              <i data-lucide="menu"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile Menu -->
      <div id="mobile-menu" class="hidden md:hidden bg-white border-b border-gray-100 absolute w-full">
        <div class="px-4 pt-2 pb-6 space-y-2">
          <button onclick="scrollToSection('buyers')" class="block w-full text-left px-3 py-3 text-base font-medium text-gray-700 hover:bg-greenstreet-50 rounded-lg">Home Buyers</button>
          <button onclick="scrollToSection('sellers')" class="block w-full text-left px-3 py-3 text-base font-medium text-gray-700 hover:bg-greenstreet-50 rounded-lg">Lot Sellers</button>
          <button onclick="window.switchView('listings')" class="block w-full text-left px-3 py-3 text-base font-medium text-gray-700 hover:bg-greenstreet-50 rounded-lg">Find a Home</button>
          <button onclick="scrollToSection('contact')" class="block w-full text-left px-3 py-3 text-base font-medium text-gray-700 hover:bg-greenstreet-50 rounded-lg">Contact</button>
        </div>
      </div>
    </nav>

    <!-- Admin Toolbar -->
    <div class="fixed top-24 left-4 z-40 hidden lg:block">
      <button id="admin-toggle-btn" class="text-xs text-gray-300 hover:text-greenstreet-600 transition-colors">
        Show AI Tools
      </button>
    </div>

    <div id="admin-toolbar" class="hidden fixed top-24 right-4 z-40 bg-white/90 backdrop-blur-md border border-greenstreet-200 shadow-xl rounded-xl p-4 w-64 lg:block" style="display: none;">
      <div class="flex items-center gap-2 mb-3 text-greenstreet-800 border-b border-gray-100 pb-2">
        <i data-lucide="sparkles" class="text-yellow-500 w-4 h-4"></i>
        <span class="font-semibold text-sm">AI Content Studio</span>
      </div>
      <p class="text-xs text-gray-500 mb-4">
        Regenerate site copy instantly using Gemini 2.5 Flash.
      </p>
      <div class="space-y-2" id="admin-buttons">
        <!-- Buttons injected by JS -->
      </div>
    </div>

    <!-- MAIN CONTENT WRAPPER -->
    <main id="main-content">
      
      <!-- LANDING PAGE VIEW -->
      <div id="landing-view">
        <!-- Hero Section -->
        <section id="hero" class="relative pt-32 pb-20 lg:pt-48 lg:pb-32 overflow-hidden bg-greenstreet-50">
          <div class="absolute top-0 right-0 -mt-20 -mr-20 w-96 h-96 bg-greenstreet-200 rounded-full blur-3xl opacity-30"></div>
          <div class="absolute bottom-0 left-0 -mb-20 -ml-20 w-96 h-96 bg-greenstreet-300 rounded-full blur-3xl opacity-30"></div>
          
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center max-w-4xl mx-auto">
              <span class="inline-block py-1 px-3 rounded-full bg-greenstreet-100 text-greenstreet-700 text-xs font-bold tracking-wide uppercase mb-6">
                Establishment • Quality • Speed
              </span>
              <h1 id="hero-headline" class="text-4xl md:text-5xl lg:text-6xl font-serif font-bold text-gray-900 leading-tight mb-6">
                New Homes, Established Neighborhoods: Your Infill Building Partner
              </h1>
              <p id="hero-subheadline" class="text-xl text-gray-600 mb-10 max-w-2xl mx-auto leading-relaxed">
                We specialize in building high-quality, production homes on vacant lots within the city's most desirable communities. Experience the perfect blend of modern living and established charm.
              </p>
              <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                <button onclick="window.switchView('listings')" class="w-full sm:w-auto px-8 py-4 bg-greenstreet-600 text-white rounded-lg font-semibold text-lg hover:bg-greenstreet-700 transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2">
                  <span id="hero-cta-primary">Find Your New Home Now</span> <i data-lucide="arrow-right" class="w-5 h-5"></i>
                </button>
                <button onclick="scrollToSection('sellers')" class="w-full sm:w-auto px-8 py-4 bg-white text-greenstreet-800 border-2 border-greenstreet-100 rounded-lg font-semibold text-lg hover:border-greenstreet-600 hover:bg-greenstreet-50 transition-all flex items-center justify-center gap-2">
                  <span id="hero-cta-secondary">Sell Your Vacant Lot for Cash</span>
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- Value Props -->
        <section class="py-20 bg-white">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
              <h2 id="props-headline" class="text-3xl font-serif font-bold text-gray-900 mb-4">The Greenstreet Difference</h2>
              <p id="props-subheadline" class="text-lg text-gray-600 max-w-2xl mx-auto">Why homeowners and land sellers trust us.</p>
            </div>
            <div id="props-grid" class="grid md:grid-cols-3 gap-8">
              <!-- Default Content -->
              <div class="p-8 bg-gray-50 rounded-2xl border border-gray-100 hover:shadow-md transition-shadow">
                <div class="w-12 h-12 bg-greenstreet-100 rounded-xl flex items-center justify-center text-greenstreet-600 mb-6">
                   <i data-lucide="check-circle-2" class="w-6 h-6"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-3">Quality Controlled Construction</h3>
                <p class="text-gray-600">Rigorous standards for every build.</p>
              </div>
              <div class="p-8 bg-gray-50 rounded-2xl border border-gray-100 hover:shadow-md transition-shadow">
                <div class="w-12 h-12 bg-greenstreet-100 rounded-xl flex items-center justify-center text-greenstreet-600 mb-6">
                   <i data-lucide="dollar-sign" class="w-6 h-6"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-3">Predictable Pricing</h3>
                <p class="text-gray-600">No hidden costs, just exceptional value.</p>
              </div>
              <div class="p-8 bg-gray-50 rounded-2xl border border-gray-100 hover:shadow-md transition-shadow">
                <div class="w-12 h-12 bg-greenstreet-100 rounded-xl flex items-center justify-center text-greenstreet-600 mb-6">
                   <i data-lucide="map-pin" class="w-6 h-6"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-3">Prime Locations</h3>
                <p class="text-gray-600">We build where you want to live.</p>
              </div>
            </div>
          </div>
        </section>

        <!-- Buyer Section -->
        <section id="buyers" class="py-24 bg-gray-50">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="lg:grid lg:grid-cols-2 lg:gap-16 items-center">
              <div class="mb-12 lg:mb-0">
                <img src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80" alt="Modern Infill Home" class="rounded-2xl shadow-2xl object-cover h-full w-full grayscale-[10%] hover:grayscale-0 transition-all duration-700">
              </div>
              <div>
                <div class="inline-flex items-center gap-2 text-greenstreet-600 font-bold tracking-wide uppercase text-sm mb-4">
                  <i data-lucide="home" class="w-4 h-4"></i> <span>For Home Buyers</span>
                </div>
                <h2 id="buyer-headline" class="text-3xl md:text-4xl font-serif font-bold text-gray-900 mb-6">New Construction, No Compromise: Move-In Ready Homes</h2>
                <p id="buyer-subheadline" class="text-lg text-gray-600 mb-8 leading-relaxed">
                  Skip the design headaches and construction delays. Our production model delivers optimized floor plans and premium finishes at an unbeatable value.
                </p>
                
                <div id="buyer-points" class="space-y-4 mb-10">
                  <div class="flex items-start gap-3">
                    <div class="mt-1 min-w-[20px]"><i data-lucide="check-circle-2" class="w-5 h-5 text-greenstreet-500"></i></div>
                    <span class="text-gray-700 font-medium">Predictable Costs & Timeline: Move in on time and on budget.</span>
                  </div>
                  <div class="flex items-start gap-3">
                    <div class="mt-1 min-w-[20px]"><i data-lucide="check-circle-2" class="w-5 h-5 text-greenstreet-500"></i></div>
                    <span class="text-gray-700 font-medium">Proven Floor Plans: Designs tested for modern living.</span>
                  </div>
                  <div class="flex items-start gap-3">
                    <div class="mt-1 min-w-[20px]"><i data-lucide="check-circle-2" class="w-5 h-5 text-greenstreet-500"></i></div>
                    <span class="text-gray-700 font-medium">Efficiency & Value: Bulk buying power passed directly to you.</span>
                  </div>
                </div>

                <div class="bg-white p-6 rounded-xl border border-gray-100 mb-8">
                   <h4 class="font-bold text-gray-900 mb-4 border-b pb-2">Simple 3-Step Process</h4>
                   <div class="flex justify-between text-sm text-center">
                      <div class="flex-1 px-2">
                          <div class="font-bold text-greenstreet-600 text-lg mb-1">01</div>
                          <div class="leading-tight text-gray-600">Choose Lot & Plan</div>
                      </div>
                      <div class="flex-1 px-2 border-l">
                          <div class="font-bold text-greenstreet-600 text-lg mb-1">02</div>
                          <div class="leading-tight text-gray-600">Select Finishes</div>
                      </div>
                      <div class="flex-1 px-2 border-l">
                          <div class="font-bold text-greenstreet-600 text-lg mb-1">03</div>
                          <div class="leading-tight text-gray-600">Close & Move In</div>
                      </div>
                   </div>
                </div>

                <button id="buyer-cta" onclick="window.switchView('listings')" class="px-8 py-3 bg-greenstreet-800 text-white rounded-lg font-semibold hover:bg-greenstreet-900 transition-colors w-full sm:w-auto">
                  See Current Available Homes & Floor Plans
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- Seller Section -->
        <section id="sellers" class="py-24 bg-greenstreet-900 text-white relative overflow-hidden">
          <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="lg:grid lg:grid-cols-2 lg:gap-16 items-start">
              <div class="mb-12 lg:mb-0">
                <div class="inline-flex items-center gap-2 text-greenstreet-300 font-bold tracking-wide uppercase text-sm mb-4">
                  <i data-lucide="dollar-sign" class="w-4 h-4"></i> <span>Acquisition</span>
                </div>
                <h2 id="seller-headline" class="text-3xl md:text-4xl font-serif font-bold mb-6">We Buy Vacant Lots for Cash: Get an Offer in 48 Hours</h2>
                <p id="seller-subheadline" class="text-lg text-greenstreet-100 mb-8 leading-relaxed opacity-90">
                  Turn your unused land into liquid assets. We offer a streamlined, commission-free process for lot owners.
                </p>

                <div id="seller-points" class="space-y-6 mb-10">
                   <div class="flex items-center gap-4 p-4 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-colors">
                      <div class="bg-greenstreet-500 p-2 rounded-full"><i data-lucide="check-circle-2" class="w-5 h-5 text-white"></i></div>
                      <span class="font-medium text-lg">Direct Cash Offer: Competitive pricing based on market value.</span>
                   </div>
                   <div class="flex items-center gap-4 p-4 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-colors">
                      <div class="bg-greenstreet-500 p-2 rounded-full"><i data-lucide="check-circle-2" class="w-5 h-5 text-white"></i></div>
                      <span class="font-medium text-lg">We Buy As-Is: No clearing, grading, or repairs needed.</span>
                   </div>
                   <div class="flex items-center gap-4 p-4 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-colors">
                      <div class="bg-greenstreet-500 p-2 rounded-full"><i data-lucide="check-circle-2" class="w-5 h-5 text-white"></i></div>
                      <span class="font-medium text-lg">Fast Closing: No agent commissions, no waiting.</span>
                   </div>
                </div>
                
                <div class="flex gap-4">
                    <div class="hidden lg:block w-px bg-greenstreet-700 h-24"></div>
                    <div>
                        <h4 class="font-bold text-greenstreet-200 mb-2">The Seller's Simple Process</h4>
                        <ol class="text-sm text-greenstreet-100 space-y-1 list-decimal list-inside">
                            <li>Submit Property Details</li>
                            <li>Receive Cash Offer</li>
                            <li>Title Review</li>
                            <li>Quick Closing</li>
                        </ol>
                    </div>
                </div>

              </div>
              
              <!-- Seller Form Mockup -->
              <div class="bg-white text-gray-900 p-8 rounded-2xl shadow-2xl">
                <h3 class="text-2xl font-bold mb-2">Get Your Offer</h3>
                <p class="text-gray-500 mb-6 text-sm">Fill out the form below. Your privacy is guaranteed.</p>
                
                <form class="space-y-4" onsubmit="event.preventDefault(); alert('Thank you! A representative will contact you shortly.')">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Property Address</label>
                    <input type="text" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-greenstreet-500 focus:outline-none focus:bg-white" placeholder="123 Main St" required />
                  </div>
                  <div class="grid grid-cols-2 gap-4">
                     <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
                        <input type="text" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-greenstreet-500 focus:outline-none focus:bg-white" placeholder="John" />
                     </div>
                     <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
                        <input type="text" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-greenstreet-500 focus:outline-none focus:bg-white" placeholder="Doe" />
                     </div>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-greenstreet-500 focus:outline-none focus:bg-white" placeholder="john@example.com" />
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                    <input type="tel" class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-greenstreet-500 focus:outline-none focus:bg-white" placeholder="(555) 123-4567" />
                  </div>
                  <button id="seller-cta" type="submit" class="w-full bg-greenstreet-600 text-white font-bold py-3 rounded-lg hover:bg-greenstreet-700 transition-colors mt-2">
                    Get Your Cash Offer Today
                  </button>
                </form>
              </div>
            </div>
          </div>
        </section>
      </div> <!-- End Landing View -->

      <!-- LISTINGS VIEW (Hidden by default) -->
      <div id="listings-view" class="hidden pt-28 pb-24 bg-gray-50 min-h-screen">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
             
             <!-- Navigation Breadcrumb -->
             <div class="mb-8 flex items-center gap-2 text-sm text-gray-500">
                <button onclick="window.switchView('landing')" class="hover:text-greenstreet-600 flex items-center gap-1">
                   <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Home
                </button>
                <span>/</span>
                <span class="text-gray-900 font-medium">Inventory</span>
             </div>

             <!-- Header -->
             <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-serif font-bold text-gray-900 mb-4">Current Inventory</h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">Explore our selection of move-in ready homes, properties under construction, and our library of buildable floor plans.</p>
             </div>
             
             <!-- Filters -->
             <div class="flex flex-wrap justify-center gap-4 mb-12">
                <button onclick="filterListings('all')" id="filter-all" class="filter-btn active px-6 py-2 rounded-full bg-greenstreet-600 text-white font-medium transition-colors shadow-sm">All Properties</button>
                <button onclick="filterListings('ready')" id="filter-ready" class="filter-btn px-6 py-2 rounded-full bg-white text-gray-600 border border-gray-200 hover:bg-greenstreet-50 hover:border-greenstreet-200 font-medium transition-colors shadow-sm">Move-In Ready</button>
                <button onclick="filterListings('construction')" id="filter-construction" class="filter-btn px-6 py-2 rounded-full bg-white text-gray-600 border border-gray-200 hover:bg-greenstreet-50 hover:border-greenstreet-200 font-medium transition-colors shadow-sm">Under Construction</button>
                <button onclick="filterListings('plan')" id="filter-plan" class="filter-btn px-6 py-2 rounded-full bg-white text-gray-600 border border-gray-200 hover:bg-greenstreet-50 hover:border-greenstreet-200 font-medium transition-colors shadow-sm">Floor Plans</button>
             </div>
        
             <!-- Grid -->
             <div id="listings-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- JS Injected -->
             </div>
             
             <!-- Empty State (Hidden) -->
             <div id="listings-empty" class="hidden text-center py-20">
                <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-400">
                    <i data-lucide="search" class="w-8 h-8"></i>
                </div>
                <h3 class="text-lg font-bold text-gray-900">No properties found</h3>
                <p class="text-gray-500">Try adjusting your filters.</p>
             </div>
          </div>
      </div>

      <!-- PROPERTY DETAIL VIEW (Hidden by default) -->
      <div id="detail-view" class="hidden pt-28 pb-24 bg-white min-h-screen">
         <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Breadcrumb -->
            <div class="mb-8 flex items-center gap-2 text-sm text-gray-500">
               <button onclick="window.switchView('listings')" class="hover:text-greenstreet-600 flex items-center gap-1">
                  <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Inventory
               </button>
               <span>/</span>
               <span id="detail-breadcrumb-title" class="text-gray-900 font-medium">Property Details</span>
            </div>

            <div class="grid lg:grid-cols-2 gap-12">
               <!-- Images -->
               <div class="space-y-4">
                  <div class="relative overflow-hidden rounded-2xl shadow-lg aspect-[4/3] group">
                     <img id="detail-main-image" src="" alt="Property" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-700">
                     <div id="detail-badge" class="absolute top-4 left-4 text-xs font-bold px-3 py-1.5 rounded-full uppercase tracking-wide shadow-sm bg-white text-gray-900">
                        Status
                     </div>
                  </div>
                  <div class="grid grid-cols-4 gap-4" id="detail-gallery">
                     <!-- JS Injected Thumbnails -->
                  </div>
               </div>

               <!-- Info -->
               <div>
                  <h1 id="detail-title" class="text-3xl md:text-4xl font-serif font-bold text-gray-900 mt-2 mb-2">Title</h1>
                  <p id="detail-address" class="text-lg text-gray-600 mb-6 flex items-center gap-2">
                     <i data-lucide="map-pin" class="w-5 h-5 text-greenstreet-500"></i> <span id="detail-address-text">Address</span>
                  </p>
                  <p id="detail-price" class="text-3xl font-bold text-greenstreet-700 mb-8">Price</p>

                  <div class="grid grid-cols-3 gap-4 mb-8 border-y border-gray-100 py-6">
                     <div class="text-center border-r border-gray-100 last:border-0">
                        <i data-lucide="bed-double" class="w-6 h-6 text-greenstreet-500 mx-auto mb-2"></i>
                        <span class="block font-bold text-gray-900 text-lg" id="detail-beds">-</span>
                        <span class="text-xs text-gray-500 uppercase tracking-wide">Beds</span>
                     </div>
                     <div class="text-center border-r border-gray-100 last:border-0">
                        <i data-lucide="bath" class="w-6 h-6 text-greenstreet-500 mx-auto mb-2"></i>
                        <span class="block font-bold text-gray-900 text-lg" id="detail-baths">-</span>
                        <span class="text-xs text-gray-500 uppercase tracking-wide">Baths</span>
                     </div>
                     <div class="text-center">
                        <i data-lucide="ruler" class="w-6 h-6 text-greenstreet-500 mx-auto mb-2"></i>
                        <span class="block font-bold text-gray-900 text-lg" id="detail-sqft">-</span>
                        <span class="text-xs text-gray-500 uppercase tracking-wide">Sqft</span>
                     </div>
                  </div>

                  <h3 class="font-bold text-gray-900 mb-3 text-lg">About this home</h3>
                  <p id="detail-description" class="text-gray-600 leading-relaxed mb-8">
                     Description goes here.
                  </p>

                  <h3 class="font-bold text-gray-900 mb-4 text-lg">Key Features</h3>
                  <ul id="detail-features" class="grid grid-cols-1 sm:grid-cols-2 gap-y-3 gap-x-6 mb-10">
                     <!-- JS Injected -->
                  </ul>

                  <div class="bg-greenstreet-50 p-8 rounded-2xl border border-greenstreet-100 text-center">
                     <h3 class="font-serif font-bold text-2xl text-gray-900 mb-2">Interested in this property?</h3>
                     <p class="text-gray-600 mb-6">Schedule a private tour or request more information today.</p>
                     <div class="flex flex-col sm:flex-row gap-4 justify-center">
                         <button onclick="alert('Inquiry sent! An agent will contact you shortly.')" class="px-8 py-3 bg-greenstreet-600 text-white rounded-lg font-bold hover:bg-greenstreet-700 transition-colors shadow-lg hover:shadow-xl">
                            Request Info
                         </button>
                         <button class="px-8 py-3 bg-white text-greenstreet-700 border border-greenstreet-200 rounded-lg font-bold hover:bg-greenstreet-50 transition-colors">
                            <i data-lucide="phone" class="w-4 h-4 inline-block mr-2"></i> (555) 867-5309
                         </button>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
    </main>

    <!-- Footer -->
    <footer id="contact" class="bg-gray-900 text-gray-300 py-12 border-t border-gray-800">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid md:grid-cols-4 gap-8">
          <div class="col-span-1 md:col-span-1">
            <div class="flex items-center mb-4">
              <div class="h-6 w-6 bg-greenstreet-500 rounded-sm mr-2 flex items-center justify-center">
                <span class="text-white font-serif font-bold text-sm">G</span>
              </div>
              <span class="font-serif font-bold text-lg text-white tracking-tight">GREENSTREET</span>
            </div>
            <p class="text-sm text-gray-400 mb-4">
              Building the future in the neighborhoods you love. Professional, predictable, production home building.
            </p>
            <div class="flex space-x-4">
              <a href="#" class="text-gray-400 hover:text-white"><i data-lucide="instagram" class="w-5 h-5"></i></a>
              <a href="#" class="text-gray-400 hover:text-white"><i data-lucide="facebook" class="w-5 h-5"></i></a>
              <a href="#" class="text-gray-400 hover:text-white"><i data-lucide="linkedin" class="w-5 h-5"></i></a>
            </div>
          </div>
          
          <div>
            <h4 class="text-white font-bold mb-4">Quick Links</h4>
            <ul class="space-y-2 text-sm">
              <li><button onclick="window.switchView('listings')" class="hover:text-greenstreet-400">Find a Home</button></li>
              <li><button onclick="scrollToSection('sellers')" class="hover:text-greenstreet-400">Sell Your Lot</button></li>
              <li><a href="#" class="hover:text-greenstreet-400">Our Process</a></li>
              <li><a href="#" class="hover:text-greenstreet-400">About Us</a></li>
            </ul>
          </div>

           <div>
            <h4 class="text-white font-bold mb-4">Legal</h4>
            <ul class="space-y-2 text-sm">
              <li><a href="#" class="hover:text-greenstreet-400">Privacy Policy</a></li>
              <li><a href="#" class="hover:text-greenstreet-400">Terms of Service</a></li>
              <li><a href="#" class="hover:text-greenstreet-400">Accessibility</a></li>
            </ul>
          </div>

          <div>
            <h4 class="text-white font-bold mb-4">Contact</h4>
            <ul class="space-y-2 text-sm">
              <li class="flex items-center gap-2"><i data-lucide="map-pin" class="w-4 h-4"></i> 123 Builder Lane, City, ST 90210</li>
              <li class="flex items-center gap-2"><i data-lucide="phone" class="w-4 h-4"></i> (555) 867-5309</li>
              <li class="flex items-center gap-2"><div class="w-4 h-4 bg-greenstreet-500 rounded-full"></div> hello@greenstreet.com</li>
            </ul>
          </div>
        </div>
        <div class="border-t border-gray-800 mt-12 pt-8 text-center text-xs text-gray-500">
          &copy; <span id="year"></span> Greenstreet Builders. All rights reserved.
        </div>
      </div>
    </footer>

    <!-- Chat Widget -->
    <div id="chat-container" class="fixed bottom-6 right-6 z-50 flex flex-col items-end">
        <!-- Chat Box -->
        <div id="chat-box" class="mb-4 w-80 sm:w-96 bg-white rounded-lg shadow-2xl overflow-hidden border border-gray-200 flex flex-col h-[500px] transition-all duration-300 ease-in-out hidden">
            <div class="bg-greenstreet-800 p-4 flex justify-between items-center">
                <div>
                <h3 class="text-white font-semibold">Greenstreet Assistant</h3>
                <p class="text-greenstreet-200 text-xs">AI-Powered Support</p>
                </div>
                <button id="close-chat" class="text-white hover:text-greenstreet-200 transition-colors">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            
            <div id="chat-messages" class="flex-1 overflow-y-auto p-4 bg-gray-50 space-y-4">
                <!-- Messages go here -->
            </div>

            <div class="p-4 bg-white border-t border-gray-100">
                <div class="flex items-center gap-2">
                <input
                    id="chat-input"
                    type="text"
                    placeholder="Type your message..."
                    class="flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-greenstreet-500 focus:border-transparent text-sm"
                />
                <button 
                    id="send-msg-btn"
                    class="p-2 bg-greenstreet-600 text-white rounded-full hover:bg-greenstreet-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                >
                    <i data-lucide="send" class="w-[18px] h-[18px]"></i>
                </button>
                </div>
            </div>
        </div>

        <!-- Toggle Button -->
        <button
            id="chat-toggle-btn"
            class="p-4 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 flex items-center gap-2 bg-greenstreet-600 text-white hover:bg-greenstreet-700"
        >
            <span id="chat-btn-text" class="text-sm font-medium pr-1 hidden sm:block">Need Help?</span>
            <i id="chat-icon" data-lucide="message-square" class="w-6 h-6"></i>
        </button>
    </div>

    <!-- Application Logic -->
    <script type="module">
        import { GoogleGenAI, Type } from "@google/genai";

        // --- Configuration & Constants ---
        // SAFELY ACCESS PROCESS.ENV to prevent crashes on GitHub Pages/Static Hosts
        const apiKey = (typeof process !== "undefined" && process.env && process.env.API_KEY) ? process.env.API_KEY : "";
        const ai = new GoogleGenAI({ apiKey });

        const SectionType = {
            HERO: 'HERO',
            VALUE_PROPS: 'VALUE_PROPS',
            BUYER: 'BUYER',
            SELLER: 'SELLER'
        };

        const INITIAL_CONTENT = {
            [SectionType.HERO]: {
                headline: "New Homes, Established Neighborhoods: Your Infill Building Partner",
                subheadline: "We specialize in building high-quality, production homes on vacant lots within the city's most desirable communities. Experience the perfect blend of modern living and established charm.",
                ctaPrimary: "Find Your New Home Now",
                ctaSecondary: "Sell Your Vacant Lot for Cash"
            },
            [SectionType.VALUE_PROPS]: {
                headline: "The Greenstreet Difference",
                subheadline: "Why homeowners and land sellers trust us.",
                points: [
                    "Quality Controlled Construction: Rigorous standards for every build.",
                    "Predictable Pricing: No hidden costs, just exceptional value.",
                    "Prime Locations: We build where you want to live."
                ]
            },
            [SectionType.BUYER]: {
                headline: "New Construction, No Compromise: Move-In Ready Homes",
                subheadline: "Skip the design headaches and construction delays. Our production model delivers optimized floor plans and premium finishes at an unbeatable value.",
                points: [
                    "Predictable Costs & Timeline: Move in on time and on budget.",
                    "Proven Floor Plans: Designs tested for modern living.",
                    "Efficiency & Value: Bulk buying power passed directly to you."
                ],
                ctaPrimary: "See Current Available Homes & Floor Plans"
            },
            [SectionType.SELLER]: {
                headline: "We Buy Vacant Lots for Cash: Get an Offer in 48 Hours",
                subheadline: "Turn your unused land into liquid assets. We offer a streamlined, commission-free process for lot owners.",
                points: [
                    "Direct Cash Offer: Competitive pricing based on market value.",
                    "We Buy As-Is: No clearing, grading, or repairs needed.",
                    "Fast Closing: No agent commissions, no waiting."
                ],
                ctaPrimary: "Get Your Cash Offer Today"
            }
        };

        // Mock Listings Data
        const LISTINGS_DATA = [
            {
                id: 1,
                type: 'ready',
                title: '2405 Oak Street',
                price: '$849,000',
                address: 'Eastside Historic District',
                beds: 4,
                baths: 3.5,
                sqft: 2850,
                description: 'Stunning modern farmhouse with chefs kitchen and covered patio.',
                fullDescription: 'Experience the perfect blend of historic charm and modern luxury in this stunning farmhouse. Located in the heart of the Eastside Historic District, this move-in ready home features a gourmet kitchen with quartz countertops, a spacious master suite with a spa-like bath, and a covered patio perfect for entertaining. Hardwood floors run throughout the main living areas, and the open-concept design maximizes natural light.',
                features: ['Gourmet Chef\'s Kitchen', 'Covered Outdoor Patio', 'Spa-like Master Bath', 'Wide-plank Hardwood Floors', 'Energy Star Certified', '2-Car Attached Garage'],
                image: 'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                gallery: [
                   'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                   'https://images.unsplash.com/photo-1484154218962-a1c002085d2f?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                   'https://images.unsplash.com/photo-1556911220-bff31c812dba?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                   'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'
                ],
                badgeColor: 'bg-green-100 text-green-800'
            },
            {
                id: 2,
                type: 'plan',
                title: 'The Boxwood',
                price: 'Starts at $625,000',
                address: 'To Be Built',
                beds: 3,
                baths: 2.5,
                sqft: 2100,
                description: 'Efficient open-concept living designed for narrow urban lots.',
                fullDescription: 'The Boxwood is our solution for narrow urban infill lots without sacrificing style or functionality. This 3-bedroom, 2.5-bath plan features an intelligent vertical layout that separates living and sleeping zones. The main floor boasts 10-foot ceilings and large windows, creating an airy feel. Upstairs, the master retreat offers privacy and luxury.',
                features: ['Optimized for Narrow Lots', '10ft Main Floor Ceilings', 'Open Concept Living/Dining', 'Large Walk-in Pantry', 'Second Floor Laundry', 'Optional Roof Deck'],
                image: 'https://images.unsplash.com/photo-1580587771525-78b9dba3b91d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                gallery: [
                    'https://images.unsplash.com/photo-1580587771525-78b9dba3b91d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1502005229766-939cb4a5ea31?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1556910103-1c02745a30bf?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'
                ],
                badgeColor: 'bg-blue-100 text-blue-800'
            },
            {
                id: 3,
                type: 'construction',
                title: '1289 Pine Avenue',
                price: '$789,000',
                address: 'North Hills',
                beds: 4,
                baths: 3,
                sqft: 2600,
                description: 'Completion due Nov 2024. Select your finishes now!',
                fullDescription: 'Currently under construction in the sought-after North Hills neighborhood, this property offers a rare opportunity to customize your final finishes. With framing complete, you can still select tile, flooring, and cabinetry colors. The layout features a main-floor guest suite and a large bonus room upstairs. Don\'t miss your chance to put your personal touch on this Greenstreet home.',
                features: ['Customization Available', 'Main Floor Guest Suite', 'Bonus Room', 'Quartz Countertops', 'Tankless Water Heater', 'Smart Home Wiring'],
                image: 'https://images.unsplash.com/photo-1599809275311-5d67e0825618?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                gallery: [
                    'https://images.unsplash.com/photo-1599809275311-5d67e0825618?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1531835551805-16d864c8d311?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1574621100236-d25a64a4aee8?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1595428774223-ef52624120d2?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'
                ],
                badgeColor: 'bg-orange-100 text-orange-800'
            },
            {
                id: 4,
                type: 'plan',
                title: 'The Magnolia',
                price: 'Starts at $750,000',
                address: 'To Be Built',
                beds: 5,
                baths: 4,
                sqft: 3200,
                description: 'Our most spacious plan featuring a main-floor guest suite.',
                fullDescription: 'The Magnolia is designed for families who need space and flexibility. This expansive floor plan includes a dedicated office, a formal dining room, and a massive great room that opens to the kitchen. The upstairs features a luxurious primary suite with dual walk-in closets and a sitting area. Perfect for wider city lots.',
                features: ['5 Bedrooms / 4 Baths', 'Dedicated Home Office', 'Formal Dining Room', 'Dual Walk-in Closets', 'Mudroom with Lockers', 'Oversized Kitchen Island'],
                image: 'https://images.unsplash.com/photo-1605276374104-dee2a0ed3cd6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                gallery: [
                    'https://images.unsplash.com/photo-1605276374104-dee2a0ed3cd6?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1484154218962-a1c002085d2f?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1507089947368-19c1da9775ae?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'
                ],
                badgeColor: 'bg-blue-100 text-blue-800'
            },
            {
                id: 5,
                type: 'ready',
                title: '882 Cedar Lane',
                price: '$925,000',
                address: 'Highland Park',
                beds: 5,
                baths: 4,
                sqft: 3100,
                description: 'Luxury finishes throughout, including a finished basement.',
                fullDescription: 'Welcome to 882 Cedar Lane, a masterpiece of modern construction in Highland Park. This home spares no expense, featuring Wolf appliances, custom cabinetry, and white oak flooring. The finished basement adds a huge recreation room and an additional bedroom/bath suite. The backyard is fully landscaped and fenced, ready for summer BBQs.',
                features: ['Finished Basement', 'Wolf Appliance Package', 'White Oak Flooring', 'Custom Cabinetry', 'Fully Landscaped Yard', 'Electric Car Charger'],
                image: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                gallery: [
                    'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1600566753376-12c8ab7fb75b?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1600566752355-35792bedcfe1?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'
                ],
                badgeColor: 'bg-green-100 text-green-800'
            },
            {
                id: 6,
                type: 'plan',
                title: 'The Sycamore',
                price: 'Starts at $595,000',
                address: 'To Be Built',
                beds: 3,
                baths: 2,
                sqft: 1800,
                description: 'Perfect entry-level luxury for urban infill lots.',
                fullDescription: 'The Sycamore proves that great things come in smaller packages. At 1800 sqft, this plan is efficient yet feels incredibly spacious due to its vaulted ceilings and clever storage solutions. It\'s the perfect entry point for those wanting new construction quality in an established neighborhood without the maintenance of a massive estate.',
                features: ['Vaulted Great Room', 'Efficient Footprint', 'Designer Lighting Package', 'Large Front Porch', 'Low Maintenance Exterior', 'High Efficiency HVAC'],
                image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                gallery: [
                    'https://images.unsplash.com/photo-1613490493576-7fde63acd811?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1593696140826-c58b09b6b952?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1493809842364-78817add7ffb?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80',
                    'https://images.unsplash.com/photo-1505691938895-1758d7feb511?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80'
                ],
                badgeColor: 'bg-blue-100 text-blue-800'
            }
        ];

        const SECTION_PROMPTS = {
            [SectionType.HERO]: `Generate persuasive web copy for a Home Builder's homepage hero section. 
            Focus on "New Homes in Established Neighborhoods". 
            Audience: Both Home Buyers and Lot Sellers. 
            Tone: Authoritative, Professional.
            Required: An impactful Headline, a 2-3 sentence Subheadline, and text for two buttons (Buyer CTA and Seller CTA).`,
            
            [SectionType.VALUE_PROPS]: `Generate copy for "The Greenstreet Difference" value proposition section.
            Focus on "Standardization, Quality, Predictability".
            Required: A Headline, Subheadline, and 3 short, punchy bullet points highlighting benefits like Quality Control and Prime Locations.`,
            
            [SectionType.BUYER]: `Generate web copy for the "Home Buyer" product section.
            Focus on "Move-In Ready Production Homes".
            Tone: Exciting, Reassuring.
            Required: Headline focusing on "No Compromise", Subheadline explaining benefits of non-custom builds, and 3 bullet points (Predictable Costs, Proven Plans, Efficiency). Includes a CTA button text.`,
            
            [SectionType.SELLER]: `Generate web copy for the "Lot Acquisition" section.
            Focus on "We Buy Vacant Lots for Cash".
            Tone: Direct, Urgent, Simple.
            Required: Direct Headline, Subheadline assuring speed/simplicity, and 3 value points (Cash Offer, As-Is, Fast Close). Includes a CTA button text.`
        };

        // --- State ---
        let content = INITIAL_CONTENT;
        let chatMessages = [
            { id: '1', role: 'model', text: 'Welcome to Greenstreet Builders. Are you looking to buy a new home or sell a vacant lot?' }
        ];
        let chatSession = null;
        let isChatOpen = false;
        let isChatLoading = false;
        let isLoadingSection = null;

        // --- Navigation Logic ---
        window.switchView = (viewId) => {
            const landing = document.getElementById('landing-view');
            const listings = document.getElementById('listings-view');
            const detail = document.getElementById('detail-view');
            const mobileMenu = document.getElementById('mobile-menu');
            
            if (mobileMenu) mobileMenu.classList.add('hidden');

            landing.classList.add('hidden');
            listings.classList.add('hidden');
            detail.classList.add('hidden');

            if (viewId === 'listings') {
                listings.classList.remove('hidden');
                renderListings('all'); // Reset filter when opening
                window.scrollTo(0,0);
            } else if (viewId === 'detail') {
                detail.classList.remove('hidden');
                window.scrollTo(0,0);
            } else {
                landing.classList.remove('hidden');
                window.scrollTo(0,0);
            }
            // Ensure icons render if we switch back
            if (window.lucide) setTimeout(() => window.lucide.createIcons(), 50);
        };

        window.scrollToSection = (id) => {
            const mobileMenu = document.getElementById('mobile-menu');
            if (mobileMenu) mobileMenu.classList.add('hidden');
            
            // If on listings page, switch back to landing
            if (document.getElementById('landing-view').classList.contains('hidden')) {
                window.switchView('landing');
                // Allow a small tick for DOM to update before scrolling
                setTimeout(() => {
                    const el = document.getElementById(id);
                    if(el) el.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            } else {
                const el = document.getElementById(id);
                if(el) el.scrollIntoView({ behavior: 'smooth' });
            }
        };

        // --- Listings Logic ---
        window.filterListings = (filterType) => {
            renderListings(filterType);
            
            // Update active button state
            document.querySelectorAll('.filter-btn').forEach(btn => {
               if (btn.onclick.toString().includes(`'${filterType}'`)) {
                   btn.classList.add('bg-greenstreet-600', 'text-white', 'border-transparent');
                   btn.classList.remove('bg-white', 'text-gray-600', 'border-gray-200');
               } else {
                   btn.classList.remove('bg-greenstreet-600', 'text-white', 'border-transparent');
                   btn.classList.add('bg-white', 'text-gray-600', 'border-gray-200');
               }
            });
        };
        
        window.openListingDetail = (id) => {
            const item = LISTINGS_DATA.find(i => i.id === id);
            if (!item) return;

            document.getElementById('detail-breadcrumb-title').textContent = item.title;
            document.getElementById('detail-title').textContent = item.title;
            document.getElementById('detail-address-text').textContent = item.address;
            document.getElementById('detail-price').textContent = item.price;
            document.getElementById('detail-beds').textContent = item.beds;
            document.getElementById('detail-baths').textContent = item.baths;
            document.getElementById('detail-sqft').textContent = item.sqft;
            document.getElementById('detail-description').textContent = item.fullDescription || item.description;
            
            // Image
            document.getElementById('detail-main-image').src = item.image;
            
            // Badge
            const badge = document.getElementById('detail-badge');
            const typeLabel = item.type === 'ready' ? 'Move-In Ready' : 
                                 item.type === 'plan' ? 'Floor Plan' : 'Under Construction';
            badge.textContent = typeLabel;
            badge.className = `absolute top-4 left-4 text-xs font-bold px-3 py-1.5 rounded-full uppercase tracking-wide shadow-sm ${item.badgeColor}`;

            // Features
            const featuresList = document.getElementById('detail-features');
            featuresList.innerHTML = '';
            const featureItems = item.features || [];
            featureItems.forEach(feat => {
                const li = document.createElement('li');
                li.className = "flex items-center gap-2 text-gray-700";
                li.innerHTML = `<i data-lucide="check" class="w-4 h-4 text-greenstreet-500"></i> ${feat}`;
                featuresList.appendChild(li);
            });

            // Gallery
            const galleryGrid = document.getElementById('detail-gallery');
            galleryGrid.innerHTML = '';
            const galleryItems = item.gallery || [item.image];
            galleryItems.forEach((imgUrl, idx) => {
                const img = document.createElement('img');
                img.src = imgUrl;
                img.className = "w-full h-20 object-cover rounded-lg cursor-pointer hover:opacity-80 transition-opacity border border-gray-100";
                img.onclick = () => {
                    document.getElementById('detail-main-image').src = imgUrl;
                };
                galleryGrid.appendChild(img);
            });

            window.switchView('detail');
        };

        function renderListings(filter) {
            const grid = document.getElementById('listings-grid');
            const emptyState = document.getElementById('listings-empty');
            grid.innerHTML = '';
            
            const filtered = filter === 'all' 
                ? LISTINGS_DATA 
                : LISTINGS_DATA.filter(item => item.type === filter);
            
            if (filtered.length === 0) {
                grid.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }

            grid.classList.remove('hidden');
            emptyState.classList.add('hidden');

            filtered.forEach(item => {
                const typeLabel = item.type === 'ready' ? 'Move-In Ready' : 
                                 item.type === 'plan' ? 'Floor Plan' : 'Under Construction';
                
                const card = document.createElement('div');
                card.className = "group bg-white rounded-2xl shadow-sm border border-gray-100 hover:shadow-xl transition-all duration-300 flex flex-col overflow-hidden";
                card.innerHTML = `
                   <div class="relative h-64 overflow-hidden">
                       <img src="${item.image}" alt="${item.title}" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-700">
                       <div class="absolute top-4 left-4 ${item.badgeColor} text-xs font-bold px-3 py-1.5 rounded-full uppercase tracking-wide shadow-sm">
                           ${typeLabel}
                       </div>
                   </div>
                   <div class="p-6 flex-1 flex flex-col">
                       <div class="mb-4">
                           <h3 class="text-2xl font-bold text-greenstreet-800">${item.price}</h3>
                           <p class="text-lg font-bold text-gray-900">${item.title}</p>
                           <p class="text-sm text-gray-500">${item.address}</p>
                       </div>
                       
                       <div class="flex items-center gap-4 mb-4 text-sm text-gray-600 border-t border-b border-gray-50 py-3">
                           <div class="flex items-center gap-1.5">
                               <i data-lucide="bed-double" class="w-4 h-4 text-greenstreet-500"></i>
                               <span><strong>${item.beds}</strong> Beds</span>
                           </div>
                           <div class="flex items-center gap-1.5">
                               <i data-lucide="bath" class="w-4 h-4 text-greenstreet-500"></i>
                               <span><strong>${item.baths}</strong> Baths</span>
                           </div>
                           <div class="flex items-center gap-1.5">
                               <i data-lucide="ruler" class="w-4 h-4 text-greenstreet-500"></i>
                               <span><strong>${item.sqft}</strong> Sqft</span>
                           </div>
                       </div>
                       
                       <p class="text-gray-500 text-sm line-clamp-2 mb-6 flex-1">${item.description}</p>
                       
                       <button onclick="window.openListingDetail(${item.id})" class="w-full py-3 bg-gray-50 hover:bg-greenstreet-50 text-greenstreet-800 font-semibold rounded-lg transition-colors flex items-center justify-center gap-2 group-hover:bg-greenstreet-600 group-hover:text-white">
                           View Details
                       </button>
                   </div>
                `;
                grid.appendChild(card);
            });
            
            if (window.lucide) window.lucide.createIcons();
        }

        // --- Content Rendering ---
        function renderAllContent() {
            // Hero
            const heroHeadline = document.getElementById('hero-headline');
            if(heroHeadline) heroHeadline.textContent = content.HERO.headline;
            
            const heroSub = document.getElementById('hero-subheadline');
            if(heroSub) heroSub.textContent = content.HERO.subheadline;
            
            const heroCta1 = document.getElementById('hero-cta-primary');
            if(heroCta1) heroCta1.textContent = content.HERO.ctaPrimary;

            const heroCta2 = document.getElementById('hero-cta-secondary');
            if(heroCta2) heroCta2.textContent = content.HERO.ctaSecondary;

            // Value Props
            document.getElementById('props-headline').textContent = content.VALUE_PROPS.headline;
            document.getElementById('props-subheadline').textContent = content.VALUE_PROPS.subheadline;
            const propsGrid = document.getElementById('props-grid');
            propsGrid.innerHTML = '';
            const icons = ['check-circle-2', 'dollar-sign', 'map-pin'];
            content.VALUE_PROPS.points.forEach((point, index) => {
                const iconName = icons[index % icons.length];
                const parts = point.split(':');
                const title = parts[0];
                const desc = parts[1] || point;
                const div = document.createElement('div');
                div.className = "p-8 bg-gray-50 rounded-2xl border border-gray-100 hover:shadow-md transition-shadow";
                div.innerHTML = `
                    <div class="w-12 h-12 bg-greenstreet-100 rounded-xl flex items-center justify-center text-greenstreet-600 mb-6">
                       <i data-lucide="${iconName}" class="w-6 h-6"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">${title}</h3>
                    <p class="text-gray-600">${desc}</p>
                `;
                propsGrid.appendChild(div);
            });

            // Buyer
            document.getElementById('buyer-headline').textContent = content.BUYER.headline;
            document.getElementById('buyer-subheadline').textContent = content.BUYER.subheadline;
            document.getElementById('buyer-cta').textContent = content.BUYER.ctaPrimary;
            const buyerPoints = document.getElementById('buyer-points');
            buyerPoints.innerHTML = '';
            content.BUYER.points.forEach(point => {
                const div = document.createElement('div');
                div.className = "flex items-start gap-3";
                div.innerHTML = `
                    <div class="mt-1 min-w-[20px]">
                      <i data-lucide="check-circle-2" class="w-5 h-5 text-greenstreet-500"></i>
                    </div>
                    <span class="text-gray-700 font-medium">${point}</span>
                `;
                buyerPoints.appendChild(div);
            });

            // Seller
            document.getElementById('seller-headline').textContent = content.SELLER.headline;
            document.getElementById('seller-subheadline').textContent = content.SELLER.subheadline;
            document.getElementById('seller-cta').textContent = content.SELLER.ctaPrimary;
            const sellerPoints = document.getElementById('seller-points');
            sellerPoints.innerHTML = '';
            content.SELLER.points.forEach(point => {
                const div = document.createElement('div');
                div.className = "flex items-center gap-4 p-4 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-colors";
                div.innerHTML = `
                    <div class="bg-greenstreet-500 p-2 rounded-full">
                        <i data-lucide="check-circle-2" class="w-5 h-5 text-white"></i>
                    </div>
                    <span class="font-medium text-lg">${point}</span>
                `;
                sellerPoints.appendChild(div);
            });

            // Footer Year
            const yearEl = document.getElementById('year');
            if (yearEl) yearEl.textContent = new Date().getFullYear();

            // Refresh Icons
            if (window.lucide) window.lucide.createIcons();
        }

        // --- Admin/AI Logic ---
        async function regenerateSection(sectionType) {
            if (isLoadingSection) return;
            
            // Check for API key presence
            if (!apiKey) {
                alert("API Key not found. This feature requires an environment configured with process.env.API_KEY.");
                return;
            }

            // UI Update: Show loading state
            const btn = document.querySelector(`button[data-section="${sectionType}"]`);
            const originalText = btn.innerHTML;
            btn.innerHTML = `<span>Loading...</span> <i data-lucide="loader-2" class="w-3.5 h-3.5 loading-spin"></i>`;
            if (window.lucide) window.lucide.createIcons();
            isLoadingSection = sectionType;

            try {
                const prompt = SECTION_PROMPTS[sectionType];
                const contentSchema = {
                    type: Type.OBJECT,
                    properties: {
                        headline: { type: Type.STRING },
                        subheadline: { type: Type.STRING },
                        points: { type: Type.ARRAY, items: { type: Type.STRING } },
                        ctaPrimary: { type: Type.STRING },
                        ctaSecondary: { type: Type.STRING },
                    },
                    required: ["headline", "subheadline"],
                };

                const response = await ai.models.generateContent({
                    model: 'gemini-2.5-flash',
                    contents: prompt,
                    config: {
                        responseMimeType: "application/json",
                        responseSchema: contentSchema,
                        systemInstruction: "You are an expert copywriter for a high-end infill home builder. Write persuasive, SEO-optimized content.",
                        temperature: 0.7,
                    }
                });

                const text = response.text;
                if (text) {
                    const newBlock = JSON.parse(text);
                    content[sectionType] = newBlock;
                    renderAllContent();
                }
            } catch (error) {
                console.error("Failed to regenerate:", error);
                alert("Failed to regenerate content. Please check API key.");
            } finally {
                isLoadingSection = null;
                // Restore button
                if (btn) btn.innerHTML = originalText;
                // Re-render admin buttons to ensure clean state or just fix this one
                renderAdminToolbar(); 
            }
        }

        function renderAdminToolbar() {
            const container = document.getElementById('admin-buttons');
            container.innerHTML = '';
            Object.values(SectionType).forEach(section => {
                const btn = document.createElement('button');
                btn.className = "w-full flex items-center justify-between px-3 py-2 text-xs font-medium text-gray-700 bg-gray-50 hover:bg-greenstreet-50 rounded-lg border border-gray-200 transition-colors disabled:opacity-50";
                btn.setAttribute('data-section', section);
                btn.onclick = () => regenerateSection(section);
                btn.innerHTML = `
                    <span>${section.replace('_', ' ')}</span>
                    <i data-lucide="sparkles" class="text-gray-400 w-3.5 h-3.5"></i>
                `;
                container.appendChild(btn);
            });
            if (window.lucide) window.lucide.createIcons();
        }

        const adminToggle = document.getElementById('admin-toggle-btn');
        if (adminToggle) {
            adminToggle.onclick = () => {
                const toolbar = document.getElementById('admin-toolbar');
                const btn = document.getElementById('admin-toggle-btn');
                if (toolbar.classList.contains('hidden')) {
                    toolbar.classList.remove('hidden');
                    btn.textContent = 'Hide AI Tools';
                } else {
                    toolbar.classList.add('hidden');
                    btn.textContent = 'Show AI Tools';
                }
            };
        }

        // --- Chat Logic ---
        function createChat() {
             return ai.chats.create({
                model: 'gemini-2.5-flash',
                config: {
                systemInstruction: `You are the Greenstreet Builders AI Assistant. 
                Your goal is to assist two types of users:
                1. Home Buyers: Looking for new construction homes in established neighborhoods. Emphasize quality, speed, and standard designs.
                2. Lot Sellers: Owners of vacant lots. Emphasize fast cash offers, no commissions, and buying "as-is".
                
                Be professional, concise, and helpful. If a user wants to sell, ask for the lot address and approximate size. If a user wants to buy, ask for their preferred neighborhood and budget range.
                Do not make up specific listing data, but speak generally about the "Greenstreet Inventory".`
                }
            });
        }

        function renderChatMessages() {
            const container = document.getElementById('chat-messages');
            container.innerHTML = '';
            chatMessages.forEach(msg => {
                const wrapper = document.createElement('div');
                wrapper.className = `flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`;
                
                const bubble = document.createElement('div');
                bubble.className = `max-w-[80%] rounded-2xl px-4 py-2 text-sm ${
                  msg.role === 'user' 
                    ? 'bg-greenstreet-600 text-white rounded-br-none' 
                    : 'bg-white text-gray-800 border border-gray-200 shadow-sm rounded-bl-none'
                }`;
                bubble.textContent = msg.text;
                
                wrapper.appendChild(bubble);
                container.appendChild(wrapper);
            });

            if (isChatLoading) {
                const wrapper = document.createElement('div');
                wrapper.className = "flex justify-start";
                wrapper.innerHTML = `
                    <div class="bg-white border border-gray-200 rounded-2xl rounded-bl-none px-4 py-2 shadow-sm">
                        <i data-lucide="loader-2" class="w-4 h-4 animate-spin text-greenstreet-600"></i>
                    </div>
                `;
                container.appendChild(wrapper);
            }
            container.scrollTop = container.scrollHeight;
            if (window.lucide) window.lucide.createIcons();
        }

        async function handleSend() {
            const input = document.getElementById('chat-input');
            const val = input.value.trim();
            if (!val || isChatLoading) return;

            // Check for API key presence
            if (!apiKey) {
                 chatMessages.push({ id: Date.now().toString(), role: 'user', text: val });
                 chatMessages.push({ id: (Date.now()+1).toString(), role: 'model', text: "I'm sorry, I can't connect to the AI service right now (Missing API Key)." });
                 renderChatMessages();
                 input.value = '';
                 return;
            }

            chatMessages.push({ id: Date.now().toString(), role: 'user', text: val });
            input.value = '';
            isChatLoading = true;
            renderChatMessages();

            try {
                if (!chatSession) chatSession = createChat();
                const result = await chatSession.sendMessage({ message: val });
                chatMessages.push({ id: (Date.now()+1).toString(), role: 'model', text: result.text });
            } catch (err) {
                console.error(err);
                chatMessages.push({ id: Date.now().toString(), role: 'model', text: "I apologize, I'm having trouble connecting. Please try again." });
            } finally {
                isChatLoading = false;
                renderChatMessages();
            }
        }

        document.getElementById('send-msg-btn').onclick = handleSend;
        document.getElementById('chat-input').onkeydown = (e) => {
            if (e.key === 'Enter') handleSend();
        };

        const toggleChat = () => {
            const chatBox = document.getElementById('chat-box');
            const chatBtn = document.getElementById('chat-toggle-btn');
            
            isChatOpen = !isChatOpen;
            
            if (isChatOpen) {
                chatBox.classList.remove('hidden');
                chatBtn.classList.remove('bg-greenstreet-600', 'hover:bg-greenstreet-700');
                chatBtn.classList.add('bg-gray-700', 'text-white', 'rotate-90');
                renderChatMessages();
            } else {
                chatBox.classList.add('hidden');
                chatBtn.classList.add('bg-greenstreet-600', 'hover:bg-greenstreet-700');
                chatBtn.classList.remove('bg-gray-700', 'text-white', 'rotate-90');
            }
        };

        document.getElementById('chat-toggle-btn').onclick = toggleChat;
        document.getElementById('close-chat').onclick = () => {
            isChatOpen = true; // force toggle to close
            toggleChat();
        };

        document.getElementById('mobile-menu-btn').onclick = () => {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        };

        // --- Initialization ---
        // Render initial content to attach event listeners and ensure Lucide icons load even if HTML is hardcoded
        // Also ensures state is synced
        renderAllContent();
        renderAdminToolbar();

    </script>
  </body>
</html>
